---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_TITLE } from '../consts';
import { Image } from 'astro:assets';

import photo1 from '../assets/À propos/IMG_0362.jpeg';
import photo2 from '../assets/À propos/IMG_0509.jpeg';
import photo3 from '../assets/À propos/IMG_5491.jpg';
import photo4 from '../assets/À propos/IMG_5498.jpg';
import photo5 from '../assets/À propos/Noel 2009 419.jpeg';
import photo6 from '../assets/À propos/Noel 2009 430.jpeg';
import photo7 from '../assets/À propos/Photo Nov. 2005- Fev.2006 018.jpeg';
---

<!doctype html>
<html lang="fr">
	<head>
		<BaseHead title={`À propos | ${SITE_TITLE}`} description="L'histoire derrière ces recettes de famille" />
		<style>
			.page-header {
				text-align: center;
				padding: 2rem 0;
			}

			.page-header h1 {
				margin: 0;
			}

			.divider {
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 1rem;
				margin: 1.5rem 0 2.5rem;
				color: var(--accent);
			}

			.divider::before,
			.divider::after {
				content: '';
				width: 80px;
				height: 1px;
				background: var(--border);
			}

			.content {
				max-width: 800px;
				margin: 0 auto;
			}

			.content p {
				text-align: justify;
				text-align-last: left;
			}

			.quote-intro {
				text-align: center;
				font-style: italic;
				color: var(--text-muted);
				margin-bottom: 0.5rem;
			}

			.quote {
				font-style: italic;
				text-align: center;
				color: var(--text-muted);
				margin: 0 0 2.5rem 0;
				padding: 1.5rem 2rem;
				border-left: 3px solid var(--accent);
				background: var(--background-alt);
				border-radius: 0 6px 6px 0;
			}

			.quote p {
				margin: 0;
				text-align: center;
			}

			.signature {
				text-align: center;
				margin-top: 3rem;
				font-family: 'Playfair Display', Georgia, serif;
				font-size: 1.3rem;
				font-style: italic;
				color: var(--text);
			}

			.end-flourish {
				text-align: center;
				margin-top: 2rem;
				color: var(--accent);
			}

			.photo-request {
				text-align: center;
				font-style: italic;
				color: var(--text-muted);
				margin-top: 1200px;
				padding-bottom: 300px;
			}

			.floating-gallery {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				pointer-events: none;
				z-index: 50;
				overflow: hidden;
			}

			.gallery-item {
				position: absolute;
				border-radius: 10px;
				overflow: hidden;
				box-shadow: 0 8px 30px rgba(90, 70, 55, 0.3);
				pointer-events: none;
				opacity: 0;
				filter: blur(10px);
				will-change: top, opacity, filter;
				transition: box-shadow 0.3s ease;
			}

			.gallery-item:nth-child(1) {
				left: 5%;
				width: 340px;
				transform: rotate(-3deg);
			}

			.gallery-item:nth-child(2) {
				left: 50%;
				transform: translateX(-50%) rotate(2.5deg);
				width: 350px;
			}

			.gallery-item:nth-child(3) {
				right: 5%;
				left: auto;
				width: 330px;
				transform: rotate(4deg);
			}

			.gallery-item:nth-child(4) {
				left: 8%;
				width: 340px;
				transform: rotate(-2.5deg);
			}

			.gallery-item:nth-child(5) {
				left: 50%;
				transform: translateX(-50%) rotate(3.5deg);
				width: 335px;
			}

			.gallery-item:nth-child(6) {
				right: 8%;
				left: auto;
				width: 345px;
				transform: rotate(-4deg);
			}

			.gallery-item:nth-child(7) {
				left: 50%;
				transform: translateX(-50%) rotate(2deg);
				width: 325px;
			}

			.gallery-item img {
				width: 100%;
				height: auto;
				aspect-ratio: 4/3;
				object-fit: cover;
				display: block;
			}

			.gallery-item::after {
				content: '';
				position: absolute;
				inset: 0;
				border: 5px solid white;
				border-radius: 10px;
				pointer-events: none;
			}

			@media (max-width: 720px) {
				.floating-gallery {
					display: none;
				}
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<div class="page-header">
				<h1>Quand Mamie Lorraine est dans la cuisine, tout est meilleur</h1>
			</div>

			<div class="divider">✦</div>

			<div class="content">
				<p>
					Que ce soit la dinde à Noël ou le jambon de Pâques, on en redemande toujours. Ses fameuses
					recettes écrites à la main — toujours rangées dans une boîte, un tiroir ou découpées d'un
					magazine — sont maintenant en ligne pour que tout le monde puisse y accéder facilement.
				</p>

				<p class="quote-intro">Comme elle dit toujours :</p>
				<div class="quote">
					<p>« Joshua, c'est mon petit-enfant préféré. »</p>
				</div>

				<p>
					Ce site regroupe les grands classiques de la cuisine familiale québécoise : les plats
					réconfortants du dimanche, les desserts des fêtes et tous ces incontournables qu'on
					supplie Mamie de refaire, année après année.
				</p>

				<p>
					Grâce à lui, toute la famille pourra retrouver ses recettes préférées, peu importe
					où elle se trouve. La prochaine fois que vous appellerez ou écrirez à Mamie, ce sera
					peut-être juste pour prendre de ses nouvelles… et non pour lui demander, une fois
					de plus : « C'était combien de tasses de farine, déjà ? »
				</p>

				<p class="signature">
					Bon appétit!
				</p>

				<div class="end-flourish">❧</div>

				<p class="photo-request">Envoyez-moi vos photos préférées — <a href="mailto:joshuaveilleux1@gmail.com">joshuaveilleux1@gmail.com</a></p>
			</div>
		</main>

		<div class="floating-gallery">
			<div class="gallery-item">
				<Image src={photo1} alt="Souvenir de famille" width={400} height={300} />
			</div>
			<div class="gallery-item">
				<Image src={photo2} alt="Souvenir de famille" width={400} height={300} />
			</div>
			<div class="gallery-item">
				<Image src={photo4} alt="Souvenir de famille" width={400} height={300} />
			</div>
			<div class="gallery-item">
				<Image src={photo3} alt="Souvenir de famille" width={400} height={300} style="object-position: center 20%;" />
			</div>
			<div class="gallery-item">
				<Image src={photo5} alt="Souvenir de famille" width={400} height={300} />
			</div>
			<div class="gallery-item">
				<Image src={photo6} alt="Souvenir de famille" width={400} height={300} />
			</div>
			<div class="gallery-item">
				<Image src={photo7} alt="Souvenir de famille" width={400} height={300} />
			</div>
		</div>

		<Footer />
		<script>
			const galleryItems = document.querySelectorAll('.gallery-item');

			// Different speeds and delay before appearing (in scroll pixels)
			const config = [
				{ speed: 1.2, scrollDelay: 50 },
				{ speed: 1.2, scrollDelay: 200 },
				{ speed: 1.2, scrollDelay: 350 },
				{ speed: 1.2, scrollDelay: 500 },
				{ speed: 1.2, scrollDelay: 650 },
				{ speed: 1.2, scrollDelay: 800 },
				{ speed: 1.2, scrollDelay: 950 }
			];

			function updatePositions() {
				const scrollY = window.scrollY;
				const viewportHeight = window.innerHeight;
				const headerHeight = 80;

				galleryItems.forEach((item, index) => {
					const { speed, scrollDelay } = config[index];

					// Effective scroll for this image (starts moving after delay)
					const effectiveScroll = Math.max(0, scrollY - scrollDelay);

					// Start below viewport, move up as user scrolls
					const top = viewportHeight + 400 - (effectiveScroll * speed);
					item.style.top = `${top}px`;

					// Calculate blur and opacity based on position
					let opacity = 0;
					let blur = 12;

					if (top > viewportHeight + 50) {
						// Below viewport - invisible
						opacity = 0;
						blur = 12;
					} else if (top > viewportHeight * 0.75) {
						// Entering from bottom - fade in, unblur
						const progress = (viewportHeight + 50 - top) / (viewportHeight * 0.25 + 50);
						opacity = progress;
						blur = 12 - (progress * 12);
					} else if (top < headerHeight) {
						// Exiting at top - fade out, blur
						opacity = 0;
						blur = 12;
					} else if (top < headerHeight + 120) {
						// Near top - fading out
						const progress = (top - headerHeight) / 120;
						opacity = progress;
						blur = 12 - (progress * 12);
					} else {
						// Middle - fully visible
						opacity = 1;
						blur = 0;
					}

					item.style.opacity = opacity;
					item.style.filter = `blur(${blur}px)`;
				});
			}

			window.addEventListener('scroll', updatePositions, { passive: true });
			window.addEventListener('resize', updatePositions);

			// Initial position
			updatePositions();
		</script>
	</body>
</html>
